#!/usr/bin/env bash
yarn lint-staged

# Block manual version edits unless allowed by our version bump script
if git diff -U0 --cached --exit-code package.json | grep -qE '"version"'; then
  if [ -z "$ALLOW_VERSION_BUMP" ]; then
    echo "ERROR: Modifying the 'version' field in package.json is not allowed."
    echo "Use 'yarn version:patch', 'yarn version:minor' or let the commit hooks bump it for you."
    exit 1
  fi
fi
